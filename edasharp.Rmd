---
title: "R Notebook"
output: html_notebook
---


#NFL 2019-2020 EDA 

#Phil Ramontal


#Libraries
```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(pwr)
```

```{r}
#Data Import
nfl_19 <- read.csv("pbp-2019.csv")
nfl_19$GameDate <- as.Date(nfl_19$GameDate)
view(nfl_19)
```

```{r}

#Hypothesis: Yards gained on 4th 

#NFL Week 1 2019
nfl <- nfl_19 [nfl_19$GameDate >= "2019/09/05" & nfl_19$GameDate <= "2020/02/03",]

#Plays with less than 4 yards to get 1st down
nfl_togo<- filter(nfl,nfl$Down == "4")

#Subset "run' & "pass"

nfl_run <- subset(nfl_togo, nfl_togo$PlayType == "RUSH")

#Mean of yards gained from run play

mean(nfl_run$Yards)

#2.45 Avg yards gained

#t.test

t.test(nfl_run$Yards, mu = 2.45, alternative = "two.sided", conf.level = 0.95)

nfl_pass <- subset(nfl_togo, nfl_togo$PlayType == "PASS")

#Mean of yards gained from pass play

mean(nfl_pass$Yards)

#5.98 yards gained

#t.test

t_test <- t.test(nfl_pass$Yards, mu = 6, alternative = "two.sided", conf.level = 0.95)
t_test

cohen.ES(test = "t", size = "medium")

#Pass power.t.test
power_4 <- pwr.t.test(d = .2, sig.level = 0.05 , power = .8, type = "one.sample")

plot(power_t)
```
 
 

```{r}
#Hypothesis: Yards gained on 3rd down

nfl1 <- nfl_19 [nfl_19$GameDate >= "2019/09/05" & nfl_19$GameDate <= "2020/02/03",]

#Plays on down 3
nfl_togo_3<- filter(nfl,nfl$Down == "3")

#Subset "run' & "pass"

nfl_run_3 <- subset(nfl_togo_3, nfl_togo_3$PlayType == "RUSH")

#Mean of yards gained from run play

mean(nfl_run_3$Yards)

#3.71 Avg yards gained

#t.test

t.test(nfl_run_3$Yards, mu = 4, alternative = "two.sided", conf.level = 0.95)

nfl_pass_3_1 <- subset(nfl_togo_3, nfl_togo_3$PlayType == "PASS")

#Mean of yards gained from pass play

mean(nfl_pass_3$Yards)

#7.25 yards gained

#t.test

t_test_3 <- t.test(nfl_pass_3$Yards, mu = 7, alternative = "two.sided", conf.level = 0.95)
t_test_3

cohen.ES(test = "t", size = "medium")

#power.t.test
power_3 <- pwr.t.test( d = .2, sig.level = 0.05 , power = .8, type = "one.sample" )

plot(power_pass)
```


```{r}
#Hypothesis: Yards gained on 2nd down

#Plays on down 2
nfl_togo_2<- filter(nfl,nfl$Down == "2")

#Subset "run' & "pass"

nfl_run_2 <- subset(nfl_togo_2, nfl_togo_2$PlayType == "RUSH")

#Mean of yards gained from run play

mean(nfl_run_2$Yards)

#4.53 Avg yards gained

#t.test

t.test_2 <- t.test(nfl_run_3$Yards, mu = 5 , alternative = "two.sided", conf.level = 0.95)
t.test_2

nfl_pass_2 <- subset(nfl_togo_2, nfl_togo_2$PlayType == "PASS")

#Mean of yards gained from pass play

mean(nfl_pass_2$Yards)

#7.25 yards gained

#t.test

t_test_2nd <- t.test(nfl_pass_3$Yards, mu = 7, alternative = "two.sided", conf.level = 0.95)
t_test_2nd

cohen.ES(test = "t", size = "large")

#power.t.test
power_2 <- pwr.t.test( d = .5, sig.level = 0.05 , power = .8, type = "one.sample")

plot(power_pass)
```



#Defense 
```{r}
#Defensive plays inside the 40 yard line 

nfl_defense<-subset(nfl, nfl$YardLine <=60)

nfl_week1 <- nfl_defense [nfl_defense$GameDate >= "2019/09/05" & nfl_defense$GameDate <= "2019/09/08",]

                                                                                                  

```

